
// â– â– â– â– â– â–  â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  
// â– â– â– â– â– â–  â– â– â– â– â– â– â– å¤šæŒ‡æ¨™æ¨™è¨˜ç³»çµ±â– â– â– â– â– â– â–  â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  
// â– â– â– â– â– â–  â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– 

//@version=6
indicator("å¤šæŒ‡æ¨™æ¨™è¨˜ç³»çµ±", overlay=true)

// â– â– â– â– â– â–  MACD è¨ˆç®— â– â– â– â– â– â– 
fast_length = input(title = "Fast Length", defval = 12)
slow_length = input(title = "Slow Length", defval = 26)
signal_length = input(title = "Signal Smoothing", defval = 9)
src = input(title = "Source", defval = close)

fast_ma = ta.ema(src, fast_length)
slow_ma = ta.ema(src, slow_length)
macd = fast_ma - slow_ma
signal = ta.ema(macd, signal_length)

// â– â– â– â– â– â–  ä¸‰å€‹æŒ‡æ¨™è¨ˆç®—ï¼ˆå¸ƒæ—å€¼è¼¸å‡ºï¼‰â– â– â– â– â– â– 
// i. å¿«ç·šä¸Šç©¿æ…¢ç·š
macd_crossover = ta.crossover(macd, signal)

// ii. å¿«ç·šä¸‹ç©¿æ…¢ç·š  
macd_crossunder = ta.crossunder(macd, signal)

// iii. é€£çºŒä¸‰æ ¹ä¸Šæ¼²
three_rising = close > close[1] and close[1] > close[2] and close[2] > close[3]

// â– â– â– â– â– â–  AæŒ‡æ¨™ ç´…è‰²é‘½çŸ³æ¨™è¨˜ è¨­å®š â– â– â– â– â– â– 
group_a = "AæŒ‡æ¨™ ç´…è‰²é‘½çŸ³æ¨™è¨˜"
a_enable = input.bool(title="å•Ÿç”¨AæŒ‡æ¨™", defval=false, group=group_a)
a_condition = input.string(title="é¸æ“‡æ¢ä»¶", 
     defval="å¿«ç·šä¸Šç©¿æ…¢ç·š", 
     options=["å¿«ç·šä¸Šç©¿æ…¢ç·š", "å¿«ç·šä¸‹ç©¿æ…¢ç·š", "é€£çºŒä¸‰æ ¹ä¸Šæ¼²"], 
     group=group_a)

// â– â– â– â– â– â–  BæŒ‡æ¨™ è—è‰²æ——å¹Ÿæ¨™è¨˜ è¨­å®š â– â– â– â– â– â– 
group_b = "BæŒ‡æ¨™ è—è‰²æ——å¹Ÿæ¨™è¨˜"
b_enable = input.bool(title="å•Ÿç”¨BæŒ‡æ¨™", defval=false, group=group_b)
b_condition = input.string(title="é¸æ“‡æ¢ä»¶", 
     defval="å¿«ç·šä¸‹ç©¿æ…¢ç·š", 
     options=["å¿«ç·šä¸Šç©¿æ…¢ç·š", "å¿«ç·šä¸‹ç©¿æ…¢ç·š", "é€£çºŒä¸‰æ ¹ä¸Šæ¼²"], 
     group=group_b)

// â– â– â– â– â– â–  CæŒ‡æ¨™ ç¶ è‰²ä¸‰è§’æ¨™è¨˜ è¨­å®š â– â– â– â– â– â– 
group_c = "CæŒ‡æ¨™ ç¶ è‰²ä¸‰è§’æ¨™è¨˜"
c_enable = input.bool(title="å•Ÿç”¨CæŒ‡æ¨™", defval=false, group=group_c)
c_condition = input.string(title="é¸æ“‡æ¢ä»¶", 
     defval="é€£çºŒä¸‰æ ¹ä¸Šæ¼²", 
     options=["å¿«ç·šä¸Šç©¿æ…¢ç·š", "å¿«ç·šä¸‹ç©¿æ…¢ç·š", "é€£çºŒä¸‰æ ¹ä¸Šæ¼²"], 
     group=group_c)

// â– â– â– â– â– â–  æ¢ä»¶åˆ¤æ–·å‡½æ•¸ â– â– â– â– â– â– 
get_condition(condition_name) =>
    switch condition_name
        "å¿«ç·šä¸Šç©¿æ…¢ç·š" => macd_crossover
        "å¿«ç·šä¸‹ç©¿æ…¢ç·š" => macd_crossunder  
        "é€£çºŒä¸‰æ ¹ä¸Šæ¼²" => three_rising
        => false

// â– â– â– â– â– â–  AæŒ‡æ¨™è§¸ç™¼æ¢ä»¶ â– â– â– â– â– â– 
a_trigger = a_enable and get_condition(a_condition)

// â– â– â– â– â– â–  BæŒ‡æ¨™è§¸ç™¼æ¢ä»¶ â– â– â– â– â– â– 
b_trigger = b_enable and get_condition(b_condition)

// â– â– â– â– â– â–  CæŒ‡æ¨™è§¸ç™¼æ¢ä»¶ â– â– â– â– â– â– 
c_trigger = c_enable and get_condition(c_condition)

// â– â– â– â– â– â–  æ¨™è¨˜é¡¯ç¤º â– â– â– â– â– â– 
// AæŒ‡æ¨™ ç´…è‰²é‘½çŸ³æ¨™è¨˜
plotshape(a_trigger, 
     style=shape.diamond, 
     location=location.belowbar, 
     color=color.red, 
     size=size.normal,
     title="AæŒ‡æ¨™ ç´…è‰²é‘½çŸ³")

// BæŒ‡æ¨™ è—è‰²æ——å¹Ÿæ¨™è¨˜
plotshape(b_trigger, 
     style=shape.flag, 
     location=location.abovebar, 
     color=color.blue, 
     size=size.normal,
     title="BæŒ‡æ¨™ è—è‰²æ——å¹Ÿ")

// CæŒ‡æ¨™ ç¶ è‰²ä¸‰è§’æ¨™è¨˜
plotshape(c_trigger, 
     style=shape.triangleup, 
     location=location.belowbar, 
     color=color.green, 
     size=size.normal,
     title="CæŒ‡æ¨™ ç¶ è‰²ä¸‰è§’")

// â– â– â– â– â– â–  è­¦å ±è¨­å®š â– â– â– â– â– â– 
alertcondition(a_trigger, title="AæŒ‡æ¨™è§¸ç™¼", message="AæŒ‡æ¨™ ç´…è‰²é‘½çŸ³æ¨™è¨˜è§¸ç™¼: {{a_condition}}")
alertcondition(b_trigger, title="BæŒ‡æ¨™è§¸ç™¼", message="BæŒ‡æ¨™ è—è‰²æ——å¹Ÿæ¨™è¨˜è§¸ç™¼: {{b_condition}}")
alertcondition(c_trigger, title="CæŒ‡æ¨™è§¸ç™¼", message="CæŒ‡æ¨™ ç¶ è‰²ä¸‰è§’æ¨™è¨˜è§¸ç™¼: {{c_condition}}")

// â– â– â– â– â– â–  è³‡è¨Šé¡¯ç¤º â– â– â– â– â– â– 
var table info_table = table.new(position.top_right, 2, 4, bgcolor=color.white, border_width=1)

if barstate.islast
    table.cell(info_table, 0, 0, "æŒ‡æ¨™", text_color=color.black, bgcolor=color.gray)
    table.cell(info_table, 1, 0, "æ¢ä»¶", text_color=color.black, bgcolor=color.gray)
    
    table.cell(info_table, 0, 1, "AæŒ‡æ¨™ ğŸ”´", text_color=color.red, bgcolor=color.white)
    table.cell(info_table, 1, 1, a_enable ? a_condition : "æœªå•Ÿç”¨", text_color=color.black, bgcolor=color.white)
    
    table.cell(info_table, 0, 2, "BæŒ‡æ¨™ ğŸ”µ", text_color=color.blue, bgcolor=color.white)
    table.cell(info_table, 1, 2, b_enable ? b_condition : "æœªå•Ÿç”¨", text_color=color.black, bgcolor=color.white)
    
    table.cell(info_table, 0, 3, "CæŒ‡æ¨™ ğŸŸ¢", text_color=color.green, bgcolor=color.white)
    table.cell(info_table, 1, 3, c_enable ? c_condition : "æœªå•Ÿç”¨", text_color=color.black, bgcolor=color.white)


